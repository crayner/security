{% trans_default_domain 'security' %}

{% if is_granted('IS_AUTHENTICATED_REMEMBERED') and idleTimeout > 0 %}
    <script src="{{ asset('bundles/hillrangesecurity/js/store/store.everything.min.js') }}"></script>
    <script src="{{ asset('bundles/hillrangesecurity/js/jquery-idleTimeout.min.js') }}"></script>
    <!-- idleTimeout -->
    <script>
        // idleTimeout
        $(document).ready(function () {
            $(document).idleTimeout({
                dialogTimeRemaining: '{{ 'idletimeout.timeRemaining'|trans }}',
                dialogStayLoggedInButton: '{{ 'idletimeout.stay'|trans }}',
                dialogLogOutNowButton: '{{ 'idletimeout.signout'|trans }}',
                idleTimeLimit: {{ idleTimeout * 60 - 30 }},
                dialogDisplayLimit: 30,
                activityEvents: 'click keypress scroll wheel mousewheel',
                sessionKeepAliveTimer: false,
                dialogTitle: '{{ 'idletimeout.title'|trans }}',
                dialogText: '{{ 'idletimeout.dialogue'|trans({'%time%': get_parameter('idleTimeout', 15) -  1}) }}',
                redirectUrl: '{{ path('hillrange_security_timeout') }}',
                customCallback: function () {
                    var close = '{{ app.request.get('closeWindow') }}';
                    if (close.length > 0)
                        window.close();
                }
            });
        });
    </script>
{% endif %}
